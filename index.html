<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Deko Trading - Journal</title>

<style>
body{margin:0;font-family:Arial;background:#0e1117;color:#e6edf3}
header{padding:20px;text-align:center;background:#111827;border-bottom:1px solid #1f2937;cursor:pointer}
h1{margin:0}
.tabs{display:flex;justify-content:center;gap:10px;margin-top:15px}
.tabbtn{padding:10px 15px;border-radius:8px;background:#1f2937;cursor:pointer;font-weight:bold}
.tabbtn.active{background:#22c55e;color:#000}
section{display:none;padding:20px}
section.active{display:block}
.calendar{display:grid;grid-template-columns:repeat(7,1fr);gap:5px;margin-top:15px}
.day{background:#1f2937;padding:12px;text-align:center;border-radius:6px;cursor:pointer}
.day:hover{background:#22c55e;color:#000}
input,textarea,select{width:100%;margin-top:5px;margin-bottom:10px;padding:8px;border-radius:6px;border:1px solid #1f2937;background:#1f2937;color:#fff}
button{padding:10px 15px;border:none;border-radius:6px;background:#22c55e;font-weight:bold;cursor:pointer}
.thumb img{width:100%;max-width:500px;margin-top:20px;border-radius:10px;border:1px solid #1f2937}
.hidden{display:none}
</style>
</head>

<body>

<header id="logo">
<h1>Deko Trading Journal</h1>
<p id="modeIndicator">Modo Lectura</p>
</header>

<div class="tabs">
<div class="tabbtn active" onclick="openTab('operativa',this)">Operativa</div>
</div>

<section id="operativa" class="active">

<input type="month" id="monthPicker" onchange="generateCalendar()">
<div id="calendar" class="calendar"></div>

<div id="imageContainer" class="thumb"></div>

<div id="journalForm" class="hidden">
<h3>Registro del Día</h3>
<label>Tipo de Entrada</label>
<input id="tipo">

<label>Contexto HTF</label>
<textarea id="contexto"></textarea>

<label>Zona 5k</label>
<textarea id="zona"></textarea>

<label>Gestión</label>
<textarea id="gestion"></textarea>

<label>Resultado</label>
<input id="resultado">

<label>Emoción</label>
<input id="emocion">

<label>Nota Personal</label>
<textarea id="nota"></textarea>

<button onclick="saveJournal()">Guardar</button>
</div>

</section>

<script>

let adminMode=false;
let selectedDate="";

document.getElementById("logo").addEventListener("click",handleLogoClicks);
let clickCount=0;

function handleLogoClicks(){
clickCount++;
if(clickCount===5){
let pass=prompt("Contraseña:");
if(pass==="Trading2026"){
adminMode=true;
document.getElementById("modeIndicator").innerText="Modo Administrador";
alert("Admin activado");
}else{
alert("Incorrecta");
}
clickCount=0;
}
}

function openTab(id,el){
document.querySelectorAll("section").forEach(s=>s.classList.remove("active"));
document.querySelectorAll(".tabbtn").forEach(b=>b.classList.remove("active"));
document.getElementById(id).classList.add("active");
el.classList.add("active");
}

function generateCalendar(){
const picker=document.getElementById("monthPicker").value;
if(!picker)return;
const [year,month]=picker.split("-");
const days=new Date(year,month,0).getDate();
const cal=document.getElementById("calendar");
cal.innerHTML="";
for(let d=1;d<=days;d++){
let div=document.createElement("div");
div.className="day";
div.innerText=d;
div.onclick=()=>selectDate(year,month,d);
cal.appendChild(div);
}
}

function selectDate(year,month,day){
const mm=month.padStart(2,"0");
const dd=String(day).padStart(2,"0");
selectedDate=`${year}-${dd}-${mm}`;

loadImage(year,mm,dd);
loadJournal();

if(adminMode){
document.getElementById("journalForm").classList.remove("hidden");
}else{
document.getElementById("journalForm").classList.add("hidden");
}
}

function loadImage(year,mm,dd){
const monthNames={"01":"enero","02":"febrero","03":"marzo","04":"abril","05":"mayo","06":"junio","07":"julio","08":"agosto","09":"septiembre","10":"octubre","11":"noviembre","12":"diciembre"};
const folder=monthNames[mm];
const path=`assets/operativa/${folder}/${year}-${dd}-${mm}_DHTS.png`;
document.getElementById("imageContainer").innerHTML=`<img src="${path}" onerror="this.style.display='none'">`;
}

function saveJournal(){
if(!selectedDate)return alert("Selecciona fecha");
const data={
tipo:tipo.value,
contexto:contexto.value,
zona:zona.value,
gestion:gestion.value,
resultado:resultado.value,
emocion:emocion.value,
nota:nota.value
};
localStorage.setItem("journal_"+selectedDate,JSON.stringify(data));
alert("Guardado");
}

function loadJournal(){
const saved=localStorage.getItem("journal_"+selectedDate);
if(saved){
const data=JSON.parse(saved);
tipo.value=data.tipo||"";
contexto.value=data.contexto||"";
zona.value=data.zona||"";
gestion.value=data.gestion||"";
resultado.value=data.resultado||"";
emocion.value=data.emocion||"";
nota.value=data.nota||"";
}else{
tipo.value="";
contexto.value="";
zona.value="";
gestion.value="";
resultado.value="";
emocion.value="";
nota.value="";
}
}

</script>

</body>
</html>
